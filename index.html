<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Школа №30</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <link
            href="{{ url_for('static', filename='assets/style/style.css') }}"
            rel="stylesheet"
    />
    <!-- Supabase JS SDK -->
    <script
            src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"
            defer
    ></script>

    <style>
        body {
            background-color: #ffffff;
            color: #000033; /* желательно, чтобы текст читался */
        }

        /* Глобально, для всех слайдов карусели */
        .carousel-item img {
            width: 100%; /* занимать всю ширину контейнера */
            height: 800px; /* или любая фиксированная/макс. высота */
            object-fit: cover; /* обрезать, сохраняя пропорции */
        }

        /* Адаптация на телефон — чуть пониже */
        @media (max-width: 576px) {
            .carousel-item img {
                height: 400px; /* поменьше для узких экранов */
            }
        }

        .carousel-item .row {
            margin-top: -1rem;
            margin-bottom: -1rem;
        }

        /* Убираем лишние отступы у .carousel-inner */
        .carousel-inner {
            padding: 0;
        }

        /* Кнопка не «растекается» */
        .btn-primary {
            min-width: 180px;
        }

        #directorModal .modal-content {
            background-color: #fff;
            color: #000;
        }

        /* На десктопе показываем сразу полный текст и прячем превью + кнопку */
        @media (max-width: 767.98px) {
            .description-preview {
                display: -webkit-box;
                -webkit-line-clamp: 3; /* 2 строки */
                -webkit-box-orient: vertical;
                overflow: hidden;
                text-overflow: ellipsis;
            }
        }

        /* На десктопе показываем весь текст сразу */
        @media (min-width: 768px) {
            .description-preview,
            .btn[data-bs-toggle="collapse"] {
                display: none !important;
            }

            .description-full {
                display: block !important;
                visibility: visible;
                height: auto !important;
            }
        }

        .navbar .nav-link {
            color: white !important;
        }

        #schoolCarousel .carousel-item a {
            position: relative;
            display: block;
            overflow: hidden;
        }

        /* кнопка «Подробнее» */
        #schoolCarousel .carousel-item a .more-btn {
            position: absolute;
            bottom: 1rem;
            right: 1rem;
            background: rgba(0, 0, 0, 0.6);
            color: #fff;
            padding: 0.4rem 0.8rem;
            border-radius: 0.3rem;
            font-size: 0.9rem;
            text-decoration: none;
            transition: background 0.2s;
        }

        #schoolCarousel .carousel-item a .more-btn:hover {
            background: rgba(0, 0, 0, 0.8);
        }

        .more-btn{
            z-index: 1055;          /* больше, чем у .carousel-control-* (по-умолчанию 1) */
            cursor: pointer;        /* чтобы явно показывался "рука" */
        }


    </style>

</head>
<body>

<!-- Навигация -->
<nav class="navbar navbar-expand-lg navbar-light shadow-sm py-2" style="background-color: #082567;">
    <div class="container-fluid px-4">
        <!-- Логотип слева -->
        <a class="navbar-brand d-flex align-items-center" href="assets/img/gerb-school.png">
            <img src="{{ url_for('static', filename='assets/img/gerb-school.png') }}" alt="Герб школы" width="40"
                 height="40" class="me-2">
            <span class="fw-bold text-white">Школа №30</span>
        </a>

        <!-- Кнопка бургер -->
        <button class="navbar-toggler bg-white" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent">
            <span class="navbar-toggler-icon"></span>
        </button>

        <!-- Меню -->
        <div class="collapse navbar-collapse" id="navbarContent">
            <ul class="navbar-nav mx-auto">
                <li class="nav-item"><a class="nav-link" href="/">Главная</a></li>
                <li class="nav-item"><a class="nav-link"
                                        href="https://ul-gimnaziya30.gosuslugi.ru/svedeniya-ob-obrazovatelnoy-organizatsii/osnovnye-svedeniya/">О
                    школе</a></li>
                <li class="nav-item">
                    <a class="nav-link" href="#teachersCarousel">Преподаватели</a>
                </li>
                <li class="nav-item"><a class="nav-link" href="https://sgo.cit73.ru/">Расписание</a></li>
                <li class="nav-item"><a class="nav-link" href="news.html">Новости</a></li>
                <li class="nav-item"><a class="nav-link" href="documents.html">Документы</a></li>
                <li class="nav-item"><a class="nav-link" href="contacts.html">Контакты</a></li>
            </ul>

            <!-- Логотип справа -->
            <a href="https://nationalprojects.ru/" target="_blank" class="d-none d-lg-block">
                <img src="{{ url_for('static', filename='assets/img/national-projects-logo.png') }}" alt="Нацпроекты"
                     height="40">
            </a>
        </div>
    </div>
</nav>


<!-- Контент -->
<main class="container my-5">
    <div class="p-4 rounded-4 shadow-sm" style="min-height: 300px; background: #7fc7ff; ">
        <div class="row align-items-stretch">
            <!-- Фото -->
            <div class="col-md-4">
                <img
                        src="{{ url_for('static', filename='assets/img/school.jpg') }}"
                        class="img-fluid h-100 w-100 rounded-4"
                        style="object-fit: cover;"
                        alt="Школа"
                >
            </div>

            <!-- Текст -->
            <div class="col-md-8 d-flex flex-column justify-content-center mt-3 mt-md-0">
                <h1 class="h3 fw-bold">Добро пожаловать в Школу №30</h1>

                <p class="lead fw-column d-md-none mb-2">
                    Начальная школа № 30 была организована в послевоенное время в посёлке Винновка.
                </p>

                <!-- Скрываться будет всё, что дальше -->
                <div class="collapse d-md-none" id="fullDesc">
                    <p class="lead  fw-column mb-2 " id="fullDesc">
                        В 1970 году в новом микрорайоне Железнодорожного района г. Ульяновска было построено здание для
                        средней образовательной школы.
                    </p>
                    <p class="lead body fw-column mb-0">
                        Муниципальное бюджетное общеобразовательное учреждение гимназия № 30 переименовано в
                        муниципальное бюджетное общеобразовательное учреждение города Ульяновска «Гимназия № 30 им.
                        Железной Дивизии» на основании распоряжения Управления образования администрации города
                        Ульяновска №172 от 25.02.2021 г. «О переименовании муниципального бюджетного
                        общеобразовательного учреждения».
                    </p>
                    <p>
                        Структура гимназии: начальная школа (1-4 классы), среднее звено(5-9 классы), старшее
                        звено(старшая школа 10-11 классы).
                    </p>
                </div>

                <!-- Кнопка (только на мобилке) -->
                <button
                        class="btn btn-outline-primary btn-sm mt-2 d-md-none"
                        type="button"
                        data-bs-toggle="collapse"
                        data-bs-target="#fullDesc"
                        aria-expanded="false"
                        aria-controls="fullDesc"
                        id="toggleDescBtn"
                >
                    …читать далее
                </button>

                <!-- Полный текст для десктопа -->
                <div class="d-none d-md-block">
                    <p class="lead fw-column mb-2">
                        Начальная школа №30 была организована в послевоенное время в посёлке Винновка.
                        В 1970 году в новом микрорайоне Железнодорожного района г. Ульяновска было построено здание для
                        средней школы.
                    </p>
                    <p class="lead fw-column mb-0">
                        Муниципальное бюджетное общеобразовательное учреждение гимназия № 30 переименовано в
                        муниципальное бюджетное общеобразовательное учреждение города Ульяновска «Гимназия № 30 им.
                        Железной Дивизии» на основании распоряжения Управления образования администрации города
                        Ульяновска №172 от 25.02.2021 г. «О переименовании муниципального бюджетного
                        общеобразовательного учреждения».
                    </p>
                </div>
            </div>
        </div>
    </div>


    <section class="container my-5">
        <div class="p-2 rounded-4 shadow-sm" style="background: #7fc7ff">
            <h2 class="fw-bold mb-2 text-dark text-center">События</h2>
            <div id="schoolCarousel" class="carousel slide" data-bs-ride="carousel">
                <div class="carousel-inner rounded-4" id="eventsContainer"></div>
                <button class="carousel-control-prev" type="button" data-bs-target="#schoolCarousel"
                        data-bs-slide="prev">
                    <span class="carousel-control-prev-icon"></span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#schoolCarousel"
                        data-bs-slide="next">
                    <span class="carousel-control-next-icon"></span>
                </button>
                <div class="carousel-indicators" id="eventsIndicators"></div>
            </div>
        </div>
    </section>

    <section class="container my-5">
        <div class="p-4 rounded-4 shadow-sm" style="background: #7fc7ff">
            <h2 class="mb-4 fw-bold">Руководство</h2>

            <div class="row align-items-start g-4">
                <!-- Фото директора -->
                <div class="col-md-3 text-center">
                    <img
                            src="{{ url_for('static', filename='assets/img/director.jpg') }}"
                            class="img-fluid rounded-4"
                            alt="Директор"
                            style="max-width:240px"
                    >
                </div>

                <!-- Контент: ФИО, телефон, часы, и обращение -->
                <div class="col-md-8">
                    <h5 class="fw-semibold mb-1">Чирковская Наталья Александровна</h5>
                    <p class="text-muted mb-2">Директор гимназии</p>

                    <p><strong>Телефон:</strong><br>8 (8422) 73-76-61</p>
                    <p><strong>Часы приёма:</strong><br>Понедельник: 16:00–17:00</p>

                    <!-- Для десктопа: показываем обращение сразу -->
                    <div class="mt-4 d-none d-md-block">
                        <h5 class="fw-bold">Дорогие друзья!</h5>
                        <p>
                            Я рада приветствовать Вас на официальном сайте нашей гимназии!
                            Информация, расположенная на страницах сайта, позволит познакомиться с историей гимназии, её
                            традициями...
                        </p>
                        <p>
                            В нашей гимназии трудится талантливый, ответственный, сильный и слаженный педагогический
                            коллектив, который прилагает немало усилий к тому, чтобы сплотить вокруг себя всех детей и
                            их родителей. Наша цель – обеспечить качественное образование, для того, чтобы каждый
                            обучающийся гимназии смог полностью реализовать себя как в учебе, так и в общественной
                            жизни. Мы делаем акцент на развитии всесторонне развитой личности и ставим себе такую
                            задачу, при которой каждый гимназист был готов не только к поступлению в высшие и средние
                            профессиональные учебные заведения, но и к жизни в современном мире. </p>
                    </div>

                    <!-- Для мобильных: кнопка открытия модалки -->
                    <div class="d-block d-md-none mt-4">
                        <button
                                class="btn btn-sm btn-outline-primary"
                                data-bs-toggle="modal"
                                data-bs-target="#directorModal"
                        >
                            Обращение директора
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <div
            class="modal fade"
            id="directorModal"
            tabindex="-1"
            aria-labelledby="directorModalLabel"
            aria-hidden="true"
    >
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="directorModalLabel">Обращение директора</h5>
                    <button
                            type="button"
                            class="btn-close"
                            data-bs-dismiss="modal"
                            aria-label="Закрыть"
                    ></button>
                </div>
                <div class="modal-body">
                    <h5 class="fw-bold">Дорогие друзья!</h5>
                    <p>
                        Я рада приветствовать Вас на официальном сайте нашей гимназии!
                        Информация, расположенная на страницах сайта, позволит познакомиться с историей гимназии, её
                        традициями и ценностями…
                    </p>
                    <p>
                        В нашей гимназии трудится талантливый, ответственный, сильный и слаженный педагогический
                        коллектив, который прилагает немало усилий к тому, чтобы сплотить вокруг себя всех детей и их
                        родителей. Наша цель – обеспечить качественное образование, для того, чтобы каждый обучающийся
                        гимназии смог полностью реализовать себя как в учебе, так и в общественной жизни. Мы делаем
                        акцент на развитии всесторонне развитой личности и ставим себе такую задачу, при которой каждый
                        гимназист был готов не только к поступлению в высшие и средние профессиональные учебные
                        заведения, но и к жизни в современном мире. </p>
                </div>
                <div class="modal-footer">
                    <button
                            type="button"
                            class="btn btn-secondary"
                            data-bs-dismiss="modal"
                    >
                        Закрыть
                    </button>
                </div>
            </div>
        </div>
    </div>

    <section class="container my-5" id="teachersSection">
        <div class="p-4 rounded-4 shadow-lg" style="background: #7fc7ff">
            <h2 class="fw-bold mb-4 text-center">Педагогический состав</h2>

            <div id="teachersCarousel" class="carousel slide" data-bs-ride="carousel">
                <div class="carousel-inner" id="teachersContainer">
                    <!-- JS вставит сюда .carousel-item -->
                </div>

                <button class="carousel-control-prev" type="button"
                        data-bs-target="#teachersCarousel" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon bg-dark rounded-circle p-2"></span>
                </button>
                <button class="carousel-control-next" type="button"
                        data-bs-target="#teachersCarousel" data-bs-slide="next">
                    <span class="carousel-control-next-icon bg-dark rounded-circle p-2"></span>
                </button>
            </div>
        </div>
    </section>

</main>

<!-- Подвал -->
<footer class="bg-dark text-white text-center py-3">
    <div class="container">
        <p class="mb-0">&copy; 2025 Школа №30. Все права защищены.</p>
    </div>
</footer>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        var collapseEl = document.getElementById('fullDesc');
        var btn = document.getElementById('toggleDescBtn');
        // Когда разворачивается
        collapseEl.addEventListener('show.bs.collapse', function () {
            btn.textContent = 'Скрыть';
        });
        // Когда сворачивается
        collapseEl.addEventListener('hide.bs.collapse', function () {
            btn.textContent = '…читать далее';
        });
    });
</script>

<script>
    document.addEventListener('DOMContentLoaded', async () => {
        // 1) Инициализация Supabase
        const SUPABASE_URL = 'https://fvcbuhnbqlqlmtxuixas.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZ2Y2J1aG5icWxxbG10eHVpeGFzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE0NzM1ODYsImV4cCI6MjA2NzA0OTU4Nn0.EvVWiwCk8lFqPY4WrDQeqW5qNgc9j6kyVumaiBO9F7Y';
        const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // 2) Загрузка и рендер «Событий» в карусель
        const { data: events, error: errEv } = await supabaseClient
            .from('events')
            .select('*')
            .order('date', { ascending: false });

        if (!errEv) {
            const evCont = document.getElementById('eventsContainer');
            const evInd  = document.getElementById('eventsIndicators');

            events.forEach((e, i) => {
                const activeClass = i === 0 ? ' active' : '';
                const imgUrl      = e.image
                    ? `/static/${e.image}`
                    : '/static/assets/img/placeholder.jpg';
                const detailUrl   = `event_detail.html?event_id=${e.id}`;

                // рендерим один слайд
                evCont.insertAdjacentHTML('beforeend', `
      <div class="carousel-item${activeClass}">
        <a href="${detailUrl}"
           class="d-block position-relative text-decoration-none">
          <img src="${imgUrl}" class="d-block w-100" alt="${e.title}">
          <!-- стилизованный блок «кнопка» -->
          <div class="more-btn btn btn-dark position-absolute bottom-0 end-0 m-3">
            Подробнее →
          </div>
          <div class="carousel-caption d-none d-md-block bg-dark bg-opacity-50 rounded">
            <h5>${e.title}</h5>
            <p>${e.description}</p>
          </div>
        </a>
      </div>
    `);

                // и индикатор
                evInd.insertAdjacentHTML('beforeend', `
      <button type="button"
              data-bs-target="#schoolCarousel"
              data-bs-slide-to="${i}"
              class="${activeClass.trim() ? 'active' : ''}">
      </button>
    `);
            });
        }

        // 3) Загрузка и рендер «Педагогического состава»
        const {data: teachers, error: errT} = await supabaseClient
            .from('teachers')
            .select('*')
            .order('id', {ascending: true});

        if (errT) {
            console.error('Ошибка загрузки преподавателей:', errT);
        } else {
            const tCont = document.getElementById('teachersContainer');

            teachers.forEach((t, i) => {
                const active = i === 0 ? ' active' : '';
                const photoUrl = `/static/teachers/${t.photo}`;

                tCont.insertAdjacentHTML('beforeend', `
        <div class="carousel-item${active}">
          <div class="row gx-0 align-items-center">
            <div class="col-md-5">
              <img src="${photoUrl}"
                   class="img-fluid rounded-4"
                   style="max-height:700px;object-fit:cover;"
                   alt="${t.name}">
            </div>
            <div class="col-md-7 p-4" style="background:#7fc7ff;">
              <h3 class="fw-bold mb-1">${t.name}</h3>
              <p class="text-secondary mb-1">${t.position}</p>
              <p class="mb-2">Опыт: ${t.experience} лет</p>
              ${t.link
                    ? `<a href="${t.link}" target="_blank" class="btn btn-primary mt-2">Профиль на Госуслугах</a>`
                    : ''}
            </div>
          </div>
        </div>
      `);
            });
        }
    });
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
